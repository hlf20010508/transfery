webpackJsonp([1],{"Am+V":function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("7+uW"),s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var a=i("VU/8")({name:"App"},s,!1,function(t){i("s347")},null,null).exports,l=i("zL8q"),o=i.n(l),r=(i("tvR6"),i("/ocq")),u=i("Gu7T"),c=i.n(u),p={data:function(){return{page:0,list:[],input:null,uploadFileList:[]}},methods:{time:function(t){var e=new Date(t);return e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDay()+"/ "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()},toBottom:function(){this.$refs.myScrollbar.wrap.scrollTop=this.$refs.myScrollbar.wrap.scrollHeight},getNewData:function(t){var e=this;this.axios.get("/get/page",{params:{page:this.page}}).then(function(i){var n,s=i.data;s.messages.length?(e.page+=1,(n=e.list).unshift.apply(n,c()(s.messages.reverse())),t.loaded()):t.complete()})},submit:function(){var t=this;console.log("submit",this.input);var e=new Date,i=!1,n=this.list.length,s=new Date(this.list[n-1].time);e.getTime()-s.getTime()>6e4&&(i=!0);var a={content:this.input,type:"text",showTime:i,time:Date.parse(e)};this.list.push(a),this.axios.post("/post/message",a),this.$nextTick(function(){return t.toBottom()}),this.input=null},uploadSuccess:function(t,e){var i=this;console.log(t,e);var n=new Date(t.time),s=!1,a=this.list.length,l=new Date(this.list[a-1].time);n.getTime()-l.getTime()>6e4&&(s=!0);var o={content:e.name,type:"file",showTime:s,time:t.time,url:t.url};this.list.push(o),this.axios.post("/post/message",o),this.$nextTick(function(){return i.toBottom()})}}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"index"},[i("el-row",[i("div",{staticClass:"index-mb"},[i("el-scrollbar",{ref:"myScrollbar",staticClass:"index-scrw",attrs:{native:!0}},[i("infinite-loading",{attrs:{direction:"top",distance:10},on:{infinite:t.getNewData}}),t._v(" "),t._l(t.list,function(e,n){return i("div",{key:n},[e.showTime?i("div",{staticClass:"index-time"},[t._v("\n            "+t._s(t.time(e.time))+"\n          ")]):t._e(),t._v(" "),i("div",{staticClass:"index-content"},["text"==e.type?i("span",[t._v(t._s(e.content))]):t._e(),t._v(" "),"file"==e.type?i("a",{attrs:{href:e.url}},[t._v("\n              "+t._s(e.content)+"\n            ")]):t._e()])])})],2)],1)]),t._v(" "),i("el-divider",{staticClass:"index-divider"}),t._v(" "),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:4}},[i("el-upload",{attrs:{action:"/post/files",multiple:"","file-list":t.uploadFileList,"on-success":t.uploadSuccess,"show-file-list":!1}},[i("div",{staticClass:"index-upload-div"},[i("i",{staticClass:"el-icon-folder index-upload",attrs:{slot:"trigger"},slot:"trigger"})])])],1)],1),t._v(" "),i("el-row",[i("el-input",{staticClass:"index-input",attrs:{type:"textarea",rows:2,placeholder:"请输入消息内容或拖入文件"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit.apply(null,arguments)}},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}})],1)],1)},staticRenderFns:[]};var f=i("VU/8")(p,d,!1,function(t){i("Am+V")},null,null).exports;n.default.use(r.a);var m=r.a.prototype.push;r.a.prototype.push=function(t){return m.call(this,t).catch(function(t){return t})};var h=new r.a({routes:[{path:"/",component:f}]}),v=i("mtWM"),g=i.n(v),_=i("aLYK"),w=i("qK+J"),x=i.n(w);n.default.use(o.a),n.default.use(_.a,g.a),n.default.use(x.a),n.default.config.productionTip=!1,new n.default({el:"#app",router:h,components:{App:a},template:"<App/>"})},s347:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.3228facaca87122771a8.js.map